import { bufferToHex } from 'ethereumjs-util'
import { MPTProofVerifier } from './../src'


async function run() {
    const stateRoot = '0xf70f7bf933416dd187fc95de784e4535fa5547db1b0b9446191945bfc457bca7';
    const target = '0x058A39bEFBBA6a41e1CcBE97C3457dcc894B0fF2';
    const accountProof = ["0xf90211a0187211bbaa53583c3ebb0512f91cd04f20db553f139dc09843878b484e84de63a05df9dcbb761b7ad219440a830433ad4c287eaf7d40fdc0a0c89bab2f50445304a0535be7674a61fe43dbe129a8643db07ad65979fa2fc53069b4cdec137e5c4b13a037a78d82a0ecd7139972dc27d78e37492b206a2a0317ca263daa5b52f16b66eaa058c90fd128f7c33989d8dba8dfda82834cb797f3cabf5803a436a11f5130a4dfa065d776a22f6ef2eb96a2537a05f5b551b1cc9bd5f8ff35315518b7411ccf635ba0f728b914d0fbab9f9523fef4973cbe7fafe1c52e60a4af00e2f0c7be92fb4c29a01a690104b30497c437237b1670c3c4aed469366beb89036dde9966f5c6107768a065d5edb37697e71a41de7cc3368b7b8406a96b40d32f9c78002a237c91f5a73ea0093792de3b522d6d77f00c3f7352465c4c217e8577ee8e127c39e9cefc2001b4a02ac5962c88f52ad472b35861a0359798c7a27ca7235e7e6a51cf602abf9ff706a02c5c2282ef8f4be1bcda63deb1b79ee32b28a8727156dc6ef407b1cd0627648da0e4ccc7292d26229ca3430a281be3e3b410dda086a22f344b94569284fe7a8ee7a07c0ca56ab7d9ad61a2b7b4796d85a026f50545ae9b60c23a85ba446511dd445ca0a31b37f79905ccfbe1c79101baf7818d61ab356f735844b04ce1ee793806736ca0b3a4635665b3bbec94e0cd836721ecedb9598354b73fd19a63d2efb06ed71dd580", "0xf90211a0b4e329e48fe66e025ea7f2a649e1c9cc44eecbdd1be70193394126270fb18be6a0834035ff663fff0940aafa80cebebbc10a79bb0ddb9c1b29de622b382fd472a0a018b753f8773cc20dcafe713254b53cc557a612f5abe3fb751423d1ff365b2070a0e7330e279efc0eed483b430f5930cce1cea8401eb3bebdafe66fa3eb340fb5d6a06d0671c69ffec4dc92e434079a9056faac51449f4cb265669111c071b62ec736a0ba4419fd8cace465f05c89a204ced347cdafcb152ebee7c65bebdf22a06c5a39a095bf0e7d39bfadedb18fe2172bc34950f404f338b8cc4201bc156c4b84b651a6a003aae583fa73d9106d1d0b71d5d1f6d0b36de466e2fe0c3c53504fcfcb10ea1da040896f4e1c9e0268608adfe8a7b2727e9da0b9a60fc621319f1113e265f628b9a05fcd0bd7fa57cad9bf3d8ccb4e8f22a57ddaefcff7712ffcf90ddb2d561dd5f3a00f4db045fd727ac83240c7d1914cde4a03c3e6ee9082a5396fee287db4f71c7ba0528d227c488a62ec72755318cb5c40fb8b6b58520e3fcffef6cc3466386e9a04a04b8cbc2089ea43025bb8bfd019a744f550038799ba53c3473fc92a5ee7aaac70a091ff258fbfa4b5923e6a13b07c31ab7c2e4d6d83c45d5cce7b2461aa1c1d67d6a002c7ee6e272ee0259133b43c88c21ea99031a79b19755bcde9a3547ac95acddda0cbdb592a1a4b480dcaf0c49a5f12ac915da7e975bc654d10f8b2bad654cef33e80", "0xf90211a039018158dbe112f562ed72fe6a49a395f089304c09d30dc6223f850587740d84a0aeb6aaea7566cac3ae66b523c85686c8d81b0cb2bcf88d98477610f839c902fda0b3d0029ddeff7fd1b4e42e090db54240e834fcc7dbdc48eeafd16cacea27c46ea0eea6e018b09a74884baba60da76bab2adf64205f71d16803a483c727a699839ea090f2787b72880856fb83824084b341a3a985ad838c0363bd61a5f67cb0763393a0693ef0ee81c90a1f311c5e22ac3a5117dc6719eeb247939fed0d04265db0d12ba0dcef8a430799b91f53a3178c9506b4be9ec083bacaa9f0c843653bda69018f90a051c996583cb908e31b6486b7ec3b66f66ff605d1c2db2d134ddd47a597f9019da000a806577265ec535e69c96daa01e05b6b59dde03606f19ff047f7abb171f876a06e54435a279fb835cfcfb97bc79c2c2efe316356f87e8045fce440e8aa35069aa0877dcdc187ae67477c5c1ed0c4e6a332ba54e39f5279519bee80c33489be74c0a05f0789250492683df2a59b50cf694abea5e0cf90572817849cc8655dee6abfcaa09a7e5667a271ae04c28ac77181b88bb33848717d2f329f1baa0e63c8c65c0763a0028a926dd05b6587740ae30a5232c6d915b539d1ac52f6f44aa65f230af52736a0043fb5ffee1b6ac362b5fd11031c768a932c483dbadff44d12b0eefade71ccb6a0cdbca9c9216bc32cb9c8ee25c940acb3642c0e7b7029f497aa445079a89cfa8f80", "0xf90211a07c63562d13c13e80f5b32957a52e9f7d7ce03b98d7e037b017eaace31a27f774a0c8960c220832511a1056f0ca0cd5a78c13f34b7d48fbc97d2d95f7e6da178056a0ad18d6118f04ab3341d6da3616bce38907d4adb341db8a1a17a8b1d1b89fbeb2a0eacf00e053640743cef733509414be1c2c83fbf525669bafcf785b774bc81f4aa0672700a0e08058e6b65add6955ec59d79223c29769a53e818dd41bea180055aea06c35e7b2e4b75503cb2afa1b722217120998806633071f678a14433209f5b3eea0fa27684fc6d082ce0566944750a6a06d2d4d671fa949910d9f013a73dbf6d515a01b3d0015a9ab5c7c7410c32ddd9f9335619ad17e7b0bc591b2c3b16f9c675d09a08acc7094209b927ced1eac46c9177416e21236a669728dbe9533ef6c75079730a0ca3409170da82bffbed1c9b50796aff6d9d0da8bf883f149940160b7bd1426d0a01ae4ff5bb85737e7ef44782741d6702ab48ea2eb800ec54c302e1e7cec82aa1ca09a1f28ca1ebcec7458a49c1fe85bde7c2e03401e71b2f7d56d1e1aa8e6bce345a0eb94977d9043e94ed302e6e5725039b3fa6516b8bd3c9dffb0d56e417bc2a85fa0f0f71b7e4c992482e4f6f6a19cb76dbc0677ec527082d9da199d3b56e00dd62ca0c1d41f3d33b3a496146fd9360b699d3d476c08ff65c1ff8eddcd2be84c296fb6a07b54c0cfd649aa71773cd83bdf3cc64b440c3844b2b0a5a978e3b5c47c8a879680", "0xf90211a09c2f80fd09ad5735e8b48e810c10eb50be1b67de0d02ea834be8637db528986ba01b000df5f1db3808910a3b12b85583d6cbc91ea22a4b02a4d751344f20e6f728a0c4fe51d3e0ebbe08f7a2bb96e72933d32ee388314b9919f706b4ea2cae7c81b2a0d6c5ea56cbfb30a464219e9bfe08e760897c1528edf54ffeb1f704cac07b679fa0d5178f14aebb189f41562e239cdac82ec57633ce76216cbf928353f46be45479a0cd11e8a1825a6ca5748daeced11ece28dd021750f74478356602cec6e6161650a09105b2600b97b32daea6f2d95d44bdf0cfc081c7e69cd81ed89180c124146ffba0a82c39ce9c4a1eb1086027cd9e42ff482de44e5b279677075b604f5426b3739ba0bece14db1ba6f69bfa65d6ef1b7aeeae8e3afd28da13562f1cff1f5135fe7a46a005fcddd1eaf4ef6f944376501760aba7e951d55c0c791b9e4aa4fcd8745ce5a8a0f1ef47813cfeed87a28760ba1be155652fb4ad2768c854011287d31f39c3dab6a07fdf6b6d248ca616148210b6a464983c94995e66b0e77f1f8b35d688b1efaedea0a43816685cbdc32c566572785cfb80d02ed6629a70dde5c5e849125ad94598aaa033659dbc169eace35715e1377d9956b58008f0810a3b617401bfde4ed721a9a5a0bc9f49aaa009e96ce702e5cb501b71c6c4ae73671161b69133c78f568a4af5d1a04377e81168904e85020f993e758881d47d3f4370aae9aa302ec8917ed196922780", "0xf901118080808080a012a95d9fda505b9c5cca50c1c54b1a73965f786eabc1c0e747f1a868591ce956a0bdcc23dbe09fdff2845ef4c1c71bf63af96ac40684cc3578895068e96f574c6ca021334143033d53025e61105c27c69a4f812c26bd163a0e43f2aaf17429c946efa0f2566fc166e724931ead36585b4ccea10b91efe58681179a05bb277d4ecfd4ed80a039b55452cbacc004a2484c05f6b3f2f3a463ba4db918f7b4fc5d5c324d8e27f880a07b16363538955224b1596e55dc2df5e2a5cf1855761cfeebe7b7c2bf10cf162e80a0884fa2acc80677d35e425782dc0dca97f07186d1b6ccfe08573bae56942f9ceaa04b1f442c922add054b7b7cf89708367d121fd17f3d3a443496f1dbc4146a3db280", "0xf8518080808080808080808080a0727b7a92bb927f614141e02d88023c3e14e60f8f1a12defc0dc74b880d3f1cd5808080a0a304cce2d775eae9357bc98003d8eb5b6a06925ac6afa27a688481ddecccf00780", "0xf8669d39e0bf66655aba83980f041431c9f4ca7b82068f134912ec3232d0c2a5b846f8440180a09c1bbadf2df00d54d36e695f2ecdc0a5072ea237070e8ab0283ae61a57d1f5cba02233d911cc823f0101eb22c361aebe50c750cc0c4e19d94eaee21e6aa3e334e5"];
    const storageSlot = '0x290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e563';
    const storageProof = ["0xf8b18080a04e918b76be51be2f02df0ac6191ec2765d401d2229e47291806815da755f5b5ea07b9117be221cda5538d728982e4445537434fa848961c71648788e23923af59880a0cdd1df073a54c37db016f018705ea2beea0cd2deafdfe8c5e732d2b2341fdefda0e6b66b537d39c6dc50d28ffb346f97ef7b21abb6ebf41c1a25ba95f9a0acf4c0808080808080a0238cb47d9c85c37f284612c260eaaba387ec0ce5ca0ac2886fbf67a3e4733097808080", "0xf85180a01794ff78675e0f48a63c8d44b565aeffdf181ea17b3fe4b5db383ea0ab99fd6080808080808080808080a02f28f647d4545f86a87e951b362a99b726085c6b32048d8f6bde0b8ebb0912e480808080", "0xf843a0200e4e770828ddbf7f7b00ab00a9f6adaf81c0dc9cc85f1f8249c256942d61d9a1a03dd7d2caffe54cd29511c20d91626b5e3a13d89d8099d7ab1605aaf2fb5818ac"];

    const account = await MPTProofVerifier.verifyAccountProof(stateRoot, target, accountProof);
    console.log("Account:\n", bufferToHex(account.nonce), bufferToHex(account.balance), bufferToHex(account.stateRoot), bufferToHex(account.codeHash));

    const storageValue = await MPTProofVerifier.verifyStorageProof(bufferToHex(account.stateRoot), storageSlot, storageProof);
    console.log("Storage Value:\n", bufferToHex(Buffer.from(storageValue)))
}

run()